{"title":"","date":"2025-02-05T20:21:46.574Z","updated":"2025-02-05T20:21:46.574Z","content":"// var script = document.createElement(\"script\");\n// script.type = \"text/javascript\";\n// script.id = 'clustrmaps';\n// script.src =  '//clustrmaps.com/map_v2.js?d=NN6CrFgiT6g5STfQdgu1v91lB8TY5dqmU7iLIxocfY0&cl=ffffff&w=a';\n// document.body.appendChild(script);\n// 12-22\n// // å®ä¾‹åŒ– VConsole å¯¹è±¡\n// var vConsole = new VConsole();\n// // å¯ç”¨ VConsole\n// vConsole.show();\n\naddMobileLive2dCss();\nJinx();\nipMap();\n\n// appç¯å¢ƒä¸æ·»åŠ ç½‘æ˜“äº‘å¤–é“¾\n// appç¯å¢ƒç½‘æ˜“äº‘å¤–é“¾ä¸æ”¯æŒï¼Œè‡ªåŠ¨åŠ è½½httpçš„ä¸œè¥¿ï¼Œå’Œåšå®¢ç½‘ç«™httpså†²çª\nif (isMobile()) {\n  addMobileLive2dCss();\n} else {\n  musicBox();\n  removeMusicBox();\n}\n\n// å†™è¿™é‡Œåº”è¯¥æ²¡äººå‘ç°å§ğŸ˜ƒğŸ˜ƒğŸ˜ƒ\nfunction Jinx() {\n  console.log(\n    \"%c Jinxå¤©å¤©å¼€å¿ƒå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ %c https://jinx66.gitee.io/\",\n    \"color:#fff;font-size: 14px;font-family: serif;background:linear-gradient(90deg,#ff4d91,#ff4d91);padding:15px 10px;\",\n    \"color:#000;background:linear-gradient(90deg,#ff4d91,#ffffff);padding:15px 10px;font-size: 14px;font-family: serif;\"\n  );\n}\n\nfunction ipMap() {\n  //æ·»åŠ iframeæ ‡ç­¾\n  var body = document.getElementsByTagName(\"body\");\n  var div = document.createElement(\"div\");\n  div.innerHTML =\n    '<a href=\"https://clustrmaps.com/site/1bv4l\" title=\"Visit tracker\"><img src=\"//www.clustrmaps.com/map_v2.png?d=NN6CrFgiT6g5STfQdgu1v91lB8TY5dqmU7iLIxocfY0&cl=ffffff\"></a>';\n  div.id = \"ip-map\";\n  document.body.appendChild(div);\n}\nfunction addMobileLive2dCss() {\n  console.log(123);\n  if (isMobile()) {\n    console.log(123);\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = \"/css/mobileLive2d.css\"; // æ›¿æ¢ä¸ºæ‚¨CSSæ–‡ä»¶çš„è·¯å¾„\n    document.head.appendChild(link);\n  }\n}\nfunction musicBox() {\n  //æ·»åŠ iframeæ ‡ç­¾\n  var body = document.getElementsByTagName(\"body\");\n  var div = document.createElement(\"div\");\n  div.innerHTML =\n    '<div id=\"drag\" class=\"move\"><iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=300 src=\"https://music.163.com/outchain/player?type=0&id=2327585234&auto=1&height=430\"></iframe><div class=\"mask\"></div><div class=\"close\"></div></div>';\n  document.body.appendChild(div);\n  // æ‹–æ‹½åŠŸèƒ½(ä¸»è¦æ˜¯è§¦å‘ä¸‰ä¸ªäº‹ä»¶ï¼šonmousedown\\onmousemove\\onmouseup)\n  var drag = document.getElementById(\"drag\");\n  var divMask = document.querySelector(\".mask\");\n\n  // ç‚¹å‡»æŸç‰©ä½“æ—¶ï¼Œç”¨dragå¯¹è±¡å³å¯ï¼Œmoveå’Œupæ˜¯å…¨å±€åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªæ–‡æ¡£é€šç”¨ï¼Œåº”è¯¥ä½¿ç”¨documentå¯¹è±¡è€Œä¸æ˜¯dragå¯¹è±¡(å¦åˆ™ï¼Œé‡‡ç”¨dragå¯¹è±¡æ—¶ç‰©ä½“åªèƒ½å¾€å³æ–¹æˆ–ä¸‹æ–¹ç§»åŠ¨)\n  drag.onmousedown = function (e) {\n    var e = e || window.event; // å…¼å®¹ieæµè§ˆå™¨\n    var diffX = e.clientX - drag.offsetLeft; // é¼ æ ‡ç‚¹å‡»ç‰©ä½“é‚£ä¸€åˆ»ç›¸å¯¹äºç‰©ä½“å·¦ä¾§è¾¹æ¡†çš„è·ç¦»=ç‚¹å‡»æ—¶çš„ä½ç½®ç›¸å¯¹äºæµè§ˆå™¨æœ€å·¦è¾¹çš„è·ç¦»-ç‰©ä½“å·¦è¾¹æ¡†ç›¸å¯¹äºæµè§ˆå™¨æœ€å·¦è¾¹çš„è·ç¦»\n    var diffY = e.clientY - drag.offsetTop;\n\n    /* ä½ç‰ˆæœ¬ie bug:ç‰©ä½“è¢«æ‹–å‡ºæµè§ˆå™¨å¯æ˜¯çª—å£å¤–éƒ¨æ—¶ï¼Œè¿˜ä¼šå‡ºç°æ»šåŠ¨æ¡ï¼Œ\n                      è§£å†³æ–¹æ³•æ˜¯é‡‡ç”¨ieæµè§ˆå™¨ç‹¬æœ‰çš„2ä¸ªæ–¹æ³•setCapture()\\releaseCapture(),è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œ\n                      å¯ä»¥è®©é¼ æ ‡æ»‘åŠ¨åˆ°æµè§ˆå™¨å¤–éƒ¨ä¹Ÿå¯ä»¥æ•è·åˆ°äº‹ä»¶ï¼Œè€Œæˆ‘ä»¬çš„bugå°±æ˜¯å½“é¼ æ ‡ç§»å‡ºæµè§ˆå™¨çš„æ—¶å€™ï¼Œ\n                      é™åˆ¶è¶…è¿‡çš„åŠŸèƒ½å°±å¤±æ•ˆäº†ã€‚ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå³å¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ³¨ï¼šè¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºonmousedownå’Œonmouseupä¸­ */\n    if (typeof drag.setCapture !== \"undefined\") {\n      drag.setCapture();\n    }\n\n    divMask.style.width = \"100%\";\n    divMask.style.height = \"100%\";\n    document.onmousemove = function (e) {\n      var e = e || window.event; // å…¼å®¹ieæµè§ˆå™¨\n      var left = e.clientX - diffX;\n      var top = e.clientY - diffY;\n\n      // æ§åˆ¶æ‹–æ‹½ç‰©ä½“çš„èŒƒå›´åªèƒ½åœ¨æµè§ˆå™¨è§†çª—å†…ï¼Œä¸å…è®¸å‡ºç°æ»šåŠ¨æ¡\n      if (left < 0) {\n        left = 0;\n      } else if (left > window.innerWidth - drag.offsetWidth) {\n        left = window.innerWidth - drag.offsetWidth;\n      }\n      if (top < 0) {\n        top = 0;\n      } else if (top > window.innerHeight - drag.offsetHeight) {\n        top = window.innerHeight - drag.offsetHeight;\n      }\n\n      // ç§»åŠ¨æ—¶é‡æ–°å¾—åˆ°ç‰©ä½“çš„è·ç¦»ï¼Œè§£å†³æ‹–åŠ¨æ—¶å‡ºç°æ™ƒåŠ¨çš„ç°è±¡\n      drag.style.left = left + \"px\";\n      drag.style.top = top + \"px\";\n    };\n    document.onmouseup = function (e) {\n      // å½“é¼ æ ‡å¼¹èµ·æ¥çš„æ—¶å€™ä¸å†ç§»åŠ¨\n      console.log(\"this\", this);\n      this.onmousemove = null;\n      this.onmouseup = null; // é¢„é˜²é¼ æ ‡å¼¹èµ·æ¥åè¿˜ä¼šå¾ªç¯ï¼ˆå³é¢„é˜²é¼ æ ‡æ”¾ä¸Šå»çš„æ—¶å€™è¿˜ä¼šç§»åŠ¨ï¼‰\n\n      // ä¿®å¤ä½ç‰ˆæœ¬ie bug\n      if (typeof drag.releaseCapture !== \"undefined\") {\n        drag.releaseCapture();\n      }\n\n      divMask.style.width = \"0\";\n      divMask.style.height = \"0\";\n    };\n  };\n  const draggableElement = document.getElementById(\"drag\");\n\n  // å­˜å‚¨ä¸Šä¸€ä¸ªè§¦æ‘¸ä½ç½®çš„åæ ‡\n  let lastTouchX = 0;\n  let lastTouchY = 0;\n\n  draggableElement.addEventListener(\"touchstart\", function (event) {\n    // è®°å½•è§¦æ‘¸å¼€å§‹æ—¶çš„ä½ç½®\n    const touch = event.touches[0];\n    lastTouchX = touch.clientX;\n    lastTouchY = touch.clientY;\n  });\n\n  draggableElement.addEventListener(\"touchmove\", function (event) {\n    // é˜»æ­¢é»˜è®¤çš„æ»šåŠ¨è¡Œä¸º\n    event.preventDefault();\n\n    // è·å–å½“å‰è§¦æ‘¸çš„ä½ç½®\n    const touch = event.touches[0];\n    const currentTouchX = touch.clientX;\n    const currentTouchY = touch.clientY;\n\n    // è®¡ç®—ç§»åŠ¨è·ç¦»\n    const deltaX = currentTouchX - lastTouchX;\n    const deltaY = currentTouchY - lastTouchY;\n\n    // è·å–å…ƒç´ å½“å‰çš„ä½ç½®\n    let elementX = parseFloat(draggableElement.style.left) || 0;\n    let elementY = parseFloat(draggableElement.style.top) || 0;\n\n    // æ›´æ–°å…ƒç´ çš„ä½ç½®\n    draggableElement.style.left = elementX + deltaX + \"px\";\n    draggableElement.style.top = elementY + deltaY + \"px\";\n\n    // æ›´æ–°ä¸Šä¸€ä¸ªè§¦æ‘¸ä½ç½®çš„åæ ‡\n    lastTouchX = currentTouchX;\n    lastTouchY = currentTouchY;\n  });\n\n  draggableElement.addEventListener(\"touchend\", function (event) {\n    // è§¦æ‘¸ç»“æŸæ—¶çš„å¤„ç†ï¼ˆå¯é€‰ï¼‰\n  });\n}\n\nfunction removeMusicBox() {\n  var myBtn = document.querySelector(\".close\");\n  myBtn.addEventListener(\"click\", function () {\n    var musicBox = document.querySelector(\".move\");\n    musicBox.style.display = \"none\";\n    musicBox.remove();\n  });\n}\nfunction isMobile() {\n  let flag = navigator.userAgent.match(\n    /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i\n  );\n  return flag;\n}\n","comments":true}